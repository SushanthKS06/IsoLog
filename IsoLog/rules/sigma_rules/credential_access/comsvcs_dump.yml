title: Credential Dumping via comsvcs.dll
id: comsvcs_minidump
status: experimental
description: Detects process memory dump using comsvcs.dll MiniDump - common LSASS dumping technique
author: IsoLog
references:
  - https://attack.mitre.org/techniques/T1003/001/
  - https://twitter.com/shaborik/status/1106549927568969733
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    CommandLine|contains|all:
      - "comsvcs"
      - "MiniDump"
  selection_alt:
    CommandLine|contains:
      - "rundll32.exe comsvcs.dll"
      - "#24"
      - "minidump"
  condition: selection or selection_alt
falsepositives:
  - Legitimate debugging activity
level: critical
tags:
  - attack.credential_access
  - attack.t1003
  - attack.t1003.001
