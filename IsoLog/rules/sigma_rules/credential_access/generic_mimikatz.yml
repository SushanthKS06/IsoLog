title: Generic Mimikatz Module Execution
id: generic_mimikatz_modules
status: experimental
description: Detects any Mimikatz module execution via command line patterns
author: IsoLog
references:
    - https://attack.mitre.org/techniques/T1003/
logsource:
    category: process_creation
    product: windows
detection:
    selection_module:
        CommandLine|contains:
            - "sekurlsa::"
            - "kerberos::"
            - "crypto::"
            - "vault::"
            - "lsadump::"
            - "dpapi::"
            - "token::"
            - "privilege::"
            - "process::"
            - "service::"
            - "event::"
            - "misc::"
            - "sid::"
    selection_common:
        CommandLine|contains:
            - "mimikatz"
            - "mimi.exe"
            - "logonpasswords"
            - "ekeys"
            - "dcsync"
            - "backupkeys"
            - "changentlm"
    condition: selection_module or selection_common
falsepositives:
    - Security testing
level: critical
tags:
    - attack.credential_access
    - attack.t1003
    - attack.t1003.001
    - attack.t1003.002
    - attack.t1003.003
    - attack.t1003.004
    - attack.t1003.006
